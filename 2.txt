This is branch 2 of part of master.